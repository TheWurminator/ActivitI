var mysql = require("mysql");
var dbinfo = require('./connection.json');
var con = mysql.createConnection(dbinfo);

//
function DBConnection() {
	con.connect(function(err){
  		if(err){
    		console.log('Error connecting to Db');
    		return;
  		}
  		console.log('Connection established');
	});
}

//Send an arbitary query to the database
DBConnection.prototype.sendQuery = function(queryString, callBack, httpResponse){
	console.log("The query you entered is " + queryString); //DEBUG
	var query = con.query(queryString, function(err, response){
		// endConnection();
		if(err){
			callBack(err, httpResponse);
		}
		else{
			callBack(response, httpResponse);
		}
	});
}

//End the connection to the database
DBConnection.prototype.endConnection = function(){
	//This is just a function that ends the connection to the server
	con.end(function(err){
		if(err){
			console.log(err);
		}
		console.log('The connection to the server has been terminated');
	});
}

module.exports = DBConnection;
