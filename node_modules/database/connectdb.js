var mysql = require("mysql");
var dbinfo = require('./connection.json');
var con = mysql.createConnection(dbinfo);

con.connect(function(err){
  if(err){
    console.log('Error connecting to Db');
    return;
  }
  console.log('Connection established');
});

//Send an arbitary query to the database
var sendQuery = function(queryString, callBack, res){
	console.log("The query you entered is " + queryString); //DEBUG

	var query = con.query(queryString, function(err, response){
		endConnection();

		if(err){
			callBack(err, res);
		}
		else{
			callBack(response, res);
		}
	});
}

//End the connection to the database
var endConnection = function(){
	//This is just a function that ends the connection to the server
	con.end(function(err){
		if(err)throw err;
		console.log('The connection to the server has been terminated');
	});
}

exports.sendQuery = sendQuery;
exports.endConnection = endConnection;